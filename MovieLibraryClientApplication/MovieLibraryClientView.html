<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <script src="Scripts/jquery-3.3.1.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var ulMovies = $('#ulMovies');

            $('#btn').click(function () {
                $.ajax({
                    type: 'GET',
                    url: "http://localhost:57145/api/Movies",
                    dataType: 'json',
                    success: function (data) {
                        ulMovies.empty();
                        $.each(data, function (index, val) {
                            var movieTitle = val.Title;
                            var movieGenre = val.Genre;
                            var movieDirectorName = val.DirectorName;
                            var btnDetails = $('<input type="button" value="Details" id="btnDetails" /> ').data('title', movieTitle).data('genre', movieGenre).data('director', movieDirectorName).on('click', function () {
                                var title = $(this).data('title');
                                var genre = $(this).data('genre');
                                var directorName = $(this).data('director');
                                ulMovies.empty()
                                ulMovies.append('<li>' + title + '</li>')
                                ulMovies.append('<li>' + genre + '</li>')
                                ulMovies.append('<li>' + directorName + '</li>')
                            });                            
                            ulMovies.append('<li>' + movieTitle + '</li>')
                            ulMovies.append(btnDetails)                            
                        });
                    }
                });
            });           

            $('#search').keypress(function () {
                var current_query = $("#search").val();
                $.ajax({
                    type: 'GET',
                    url: "http://localhost:57145/api/Movies",
                    dataType: 'json',
                    success: function (data) {
                        ulMovies.empty();
                        $.each(data, function (index, val) {
                            var movieTitle = val.Title;
                            var movieGenre = val.Genre;
                            var movieDirectorName = val.DirectorName;
                            if (movieTitle == current_query || movieGenre == current_query || movieDirectorName == current_query) {
                                var btnDetails = $('<input type="button" value="Details" id="btnDetails" /> ').data('title', movieTitle).data('genre', movieGenre).data('director', movieDirectorName).on('click', function () {
                                    var title = $(this).data('title');
                                    var genre = $(this).data('genre');
                                    var directorName = $(this).data('director');
                                    ulMovies.empty()
                                    ulMovies.append('<li>' + title + '</li>')
                                    ulMovies.append('<li>' + genre + '</li>')
                                    ulMovies.append('<li>' + directorName + '</li>')
                                });
                                ulMovies.append('<li>' + movieTitle + '</li>')
                                ulMovies.append(btnDetails)
                            }                            
                        });
                    }
                });
            });

            $('#btnClear').click(function () {
                ulMovies.empty();
            });
        });

    </script>
</head>
<body>
    <input id="btn" type="button" value="Get All Movies" />
    <input id="btnClear" type="button" value="Clear" />
    <input id="search" type="search" placeholder="Search" />
    <ul id="ulMovies"></ul>
</body>
</html>